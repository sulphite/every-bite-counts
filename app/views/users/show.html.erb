<div class="user-show-container w-100">

  <div class="mydon-headers d-flex">
    <div class="header-sect shadow-sm rounded p-2">
      <h2><%= @user.username %>'s Donuts</h2>
      <% if @user == current_user %>
        <h3>You have <%= current_user.donuts.count %> Donut(s)</h3>
      <% else %>
        <h3>They have <%= @user.donuts.count %> Donut(s)</h3>
      <% end %>
    </div>

    <div class="review-sect rounded shadow-sm p-2">
      <% if current_user == @user %>
        <h3>Your Reviews</h3>
      <% else %>
        <h3>This User's Reviews</h3>
      <% end %>
    </div>
  </div>

    <div class="detail-cont d-flex">
      <div class="container card-cont w-50">
        <div class="container donut-grid">
          <% @donuts.shuffle.each do |donut| %>
          <div class="card rounded border-0 pt-4">
            <%= link_to donut_path(donut.id), class: "text-decoration-none d-flex flex-column align-items-center justify-content-center w-100" do %>
              <% if donut.photo.key %>
                <%= cl_image_tag donut.photo.key, crop: :fill, class: "donut-image" %>
              <% else %>
              <%# placeholder image %>
                <div class="donut-image" style="background-image: url(<%= image_path 'https://www.errenskitchen.com/wp-content/uploads/2020/01/Baked-Vanilla-Donuts-1-4.jpg' %>)"></div>
              <% end %>
                <div class="card-body flex-grow-1 donut-info w-100">
                  <span class="fw-bold"><%= donut.title %></span>
                  <span class="text-muted"><%= donut.location %></span>
                  <span class="text-muted"><%= donut.user.username %></span>
                </div>
            <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <br>
      <%# reviews section %>
      <div class="this-user-reviews">
        <% @reviews.each do |review| %>
          <% if @user == review.booking.donut.user %>
            <div class="d-flex review-card">
              <div class="reviewer-info">
                <% if review.booking.user.photo.key %>
                <%# user avatar %>
                  <%= cl_image_tag review.booking.user.photo.key, width: 50, class: "rounded-circle" %>
                <% else %>
                <%# placeholder image %>
                  <%=  image_tag "https://kitt.lewagon.com/placeholder/users/ssaunier", class: "avatar dropdown-toggle", id: "navbarDropdown", data: { bs_toggle: "dropdown" }, 'aria-haspopup': true, 'aria-expanded': false %>
                <% end %>
                <h5 class=""><%= review.booking.user.username %></h5>
                <p class="">Rating: <%= review.rating %></p>
              </div>
              <div class="review-content">
                <p><%= review.content %></p>
                <%# ability to edit if own review %>
                <% if current_user == review.booking.user %>
                  <%= link_to 'Edit Review', new_booking_review_path(review.booking), class: "btn btn-primary" %>
                <% end %>
              </div>
            </div>
            <br>
            <% end %>
          <% end %>
      </div>
    </div>
</div>
